<!DOCTYPE html>
<html>
<head>
    <meta charset='UTF-8'>
  <title>Test Canvas</title>
  <script type="text/javascript" src='stats.min.js'></script>
  <script src="kontra.js"></script>
  <style type="text/css">
  html, body, canvas {
    margin: 0;
    background: #3cbcfc;
  }
  </style>
</head>
<body>
  <canvas id="game" style="background: #3cbcfc"></canvas>
  <script id="code">
const stats = new Stats();
document.body.appendChild(stats.dom);  






var image = new Image();
image.src = 'chip.png';


var loop = kontra.gameLoop({
  update: function() {
    stats.begin();

    updateSprites();
  },
  render: function() {
    for(var i in sprites) {
      sprites[i].render();
    }

    stats.end();
  }
});

var cx, cy;
var sprites = [];

function updateSprites(dt) {
  for(var i in sprites) {
    sprites[i].angle += sprites[i].speed;
    if(sprites[i].angle >= 360) {
      sprites[i].angle -= 360;
    }
    


    sprites[i].x = cx + Math.floor(sprites[i].center[0] + sprites[i].radius * Math.sin(sprites[i].angle * Math.PI / 180));
    sprites[i].y = cy + Math.floor(sprites[i].center[1] + sprites[i].radius * Math.cos(sprites[i].angle * Math.PI / 180));

  }
}

function init() {
  



  for(var i = 0; i < 20000; i++) {
    sprites[i] = kontra.sprite({
      x: 0,
      y: 0,
      center: [- 40 + Math.round(Math.random()*80), - 40 + Math.round(Math.random()*80)],
      radius: 50 + Math.round(Math.random() * 200),
      angle: Math.random()*360,
      speed: 1 + Math.round(Math.random()*5),
      width: 24,
      height: 24,
      image: image
    });

  }
}

window.addEventListener('resize', resizeWindow, false);

function resizeWindow() {
  var canvas = document.getElementById('game');
  canvas.width = window.innerWidth - 50;
  canvas.height = window.innerHeight - 50;
  cx = Math.round(canvas.width / 2);
  cy = Math.round(canvas.height / 2);
}

image.onload = function() {
 
  resizeWindow();

  kontra.init();
  init();
  
  loop.start();
}

  </script>
  
</body>
</html>