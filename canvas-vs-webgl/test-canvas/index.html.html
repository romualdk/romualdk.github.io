<!DOCTYPE html>
<html>
<head>
    <meta charset='UTF-8'>
  <title>Test Canvas</title>
  <script type="text/javascript" src='stats.min.js'></script>
  <script src="kontra.js"></script>
</head>
<body>
  <canvas id="game" width="640" height="480" style="background: #3cbcfc"></canvas>
  <script id="code">
const stats = new Stats();
document.body.appendChild(stats.dom);  



kontra.init();


var image = new Image();
image.src = 'chip.png';

var midX = kontra.canvas.width / 2;
var midY = kontra.canvas.height / 2;

var fields = [
  kontra.sprite({
    x: midX - 75,
    y: midY + 20,
    width: 24,
    height: 24,
    image: image,
    mass: 900,
    size: 3
  }),
  kontra.sprite({
    x: midX + 25,
    y: midY + 10,
    width: 24,
    height: 24,
    image: image,
    mass: -50,
    size: 3
  })
];

var pool = kontra.pool({
  create: kontra.sprite,
  maxSize: 5000,
  fill: true
});

/*
// redefine sprite update to account for fields
kontra.sprite.prototype.update = function() {
  // apply field
  var totalAccelerationX = 0
  var totalAccelerationY = 0;

  for (var i = 0, field; field = fields[i]; i++) {

    var vectorX = field.x - this.x;
    var vectorY = field.y - this.y;

    var force = field.mass / Math.pow(vectorX * vectorX + vectorY * vectorY, 1.5);

    totalAccelerationX += vectorX * force;
    totalAccelerationY += vectorY * force;
  }

  this.acceleration.x = totalAccelerationX
  this.acceleration.y = totalAccelerationY

  this.advance();
};*/


var loop = kontra.gameLoop({
  update: function() {
    stats.begin();

    updateSprites();
  },
  render: function() {
    //pool.render();

    for(var i in sprites) {
      sprites[i].render();
    }

    stats.end();
  }
});



var sprites = [];

function updateSprites(dt) {
  for(var i in sprites) {
    sprites[i].angle += sprites[i].speed;
    if(sprites[i].angle >= 360) {
      sprites[i].angle -= 360;
    }
    


    sprites[i].x = Math.floor(sprites[i].center[0] + sprites[i].radius * Math.sin(sprites[i].angle * Math.PI / 180));
    sprites[i].y = Math.floor(sprites[i].center[1] + sprites[i].radius * Math.cos(sprites[i].angle * Math.PI / 180));

  }
}

function initSprites() {

  for(var i = 0; i < 1000; i++) {
    sprites[i] = kontra.sprite({
      x: 0,
      y: 0,
      center: [320 - 40 + Math.round(Math.random()*80), 240 - 40 + Math.round(Math.random()*80)],
      radius: 50 + Math.round(Math.random() * 200),
      angle: Math.random()*360,
      speed: 1 + Math.round(Math.random()*5),
      width: 24,
      height: 24,
      image: image
    });

  }
}

image.onload = function() {
  initSprites();
  loop.start();
}

  </script>
  
</body>
</html>