!function(t){var e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function s(t,e,i){const s=i?document.getElementById(i):document.createElement("canvas");return s.width=t,s.height=e,s.ctx=s.getContext("2d"),s}i.r(e);const a=[["#dd4e54","#ff5960","#4b3733","#5d433e","#ead94c","#4a3632"],["#2c5460","#3a7080","#2c5460","#67bd39","#bcdc2f","#59a331"],["#2184d5","#3399cc","#10456d","#3a4750","#f3f3f3","#303841"],["#ffd944","#ffe580","#d7c745","#49b47e","#94dd4d","#409f6e"]],n=12,r=13,l=14,c=[[["M 0 0 16 0 16 16 0 16",0]],[["M 0 0 16 0 16 16 0 16",3],["M 3 8, A 5 5 0 1 1 13 8, A 5 5 0 1 1 3 8",4],["M 4 8, A 4 4 0 1 1 12 8, A 4 4 0 1 1 4 8",3]],[["M 0 0 16 0 16 16 0 16",3],["M 5 8, A 3 3 0 1 1 11 8, A 3 3 0 1 1 5 8",4]],[["M 0 0 16 0 16 16 0 16",3],["M 3 8, A 5 5 0 1 1 13 8, A 5 5 0 1 1 3 8",4],["M 4 8, A 4 4 0 1 1 12 8, A 4 4 0 1 1 4 8",3],["M 5 8, A 3 3 0 1 1 11 8, A 3 3 0 1 1 5 8",4]],[["M 0 0 16 0 16 16 0 16",1],["M 0 1 16 1 16 16 0 16",0],["M 0 6 4 4 8 6 12 4 16 6 16 16 0 16",4],["M 0 8 4 6 8 8 12 6 16 8 16 16 0 16",3],["M 0 12 4 10 8 12 12 10 16 12 16 16 0 16",5]],[["M 0 4, A 4 4 0 0 1 4 0, L 16 0 16 16 0 16",1],["M 1 4, A 3 3 0 0 1 4 1, L 16 1 16 16 1 16",0],["M 0 6 4 4 8 6 12 4 16 6 16 16 0 16",4],["M 0 8 4 6 8 8 12 6 16 8 16 16 0 16",3],["M 0 12 4 10 8 12 12 10 16 12 16 16 0 16",5]],[["M 12 0, A 4 4 0 0 1 16 4, L 16 16 0 16 0 0",1],["M 12 1, A 3 3 0 0 1 15 4, L 15 16 0 16 0 1",0],["M 0 6 4 4 8 6 12 4 16 6 16 16 0 16",4],["M 0 8 4 6 8 8 12 6 16 8 16 16 0 16",3],["M 0 12 4 10 8 12 12 10 16 12 16 16 0 16",5]],[["M 0 4, A 4 4 0 0 1 4 0, L 12 0, A 4 4 0 0 1 16 4, L 16 16 0 16",1],["M 1 4, A 3 3 0 0 1 4 1, L 12 1, A 3 3 0 0 1 15 4, L 15 16 1 16",0],["M 0 6 4 4 8 6 12 4 16 6 16 16 0 16",4],["M 0 8 4 6 8 8 12 6 16 8 16 16 0 16",3],["M 0 12 4 10 8 12 12 10 16 12 16 16 0 16",5]],[["M 0 16 16 0 16 16",1],["M 1 16 16 1 16 16",0],["M 6 16 16 6 16 16",4],["M 8 16 16 8 16 16",3],["M 12 16 16 12 16 16",5]],[["M 0 0 0 0 16 0 16 16 0 16",1],["M 0 1 1 0 16 0 16 16 0 16",0],["M 0 6 6 0 16 0 16 16 0 16",4],["M 0 8 8 0 16 0 16 16 0 16",3],["M 0 12 12 0 16 0 16 16 0 16",5]],[["M 0 0 16 16 0 16",1],["M 0 1 15 16 0 16",0],["M 0 6 10 16 0 16",4],["M 0 8 8 16 0 16",3],["M 0 12 4 16 0 16",5]],[["M 0 0 0 0 16 0 16 16 0 16",1],["M 15 0 16 1 16 16 0 16 0 0",0],["M 10 0 16 6 16 16 0 16 0 0",4],["M 8 0 16 8 16 16 0 16 0 0",3],["M 4 0 16 12 16 16 0 16 0 0",5]],[["M 0 2, Q 4 0 8 2, Q 12 4 16 2, L 16 16 0 16",4],["M 0 3, Q 4 1 8 3, Q 12 5 16 3, L 16 16 0 16",1],["M 0 8, Q 4 6 8 8, Q 12 10 16 8, L 16 16 0 16",0]],[["M 7 8 9 8 9 16 7 16",5],["M 5 9, A 3 6 0 1 1 11 9, A 3 4 0 1 1 5 9",1],["M 8 16, A 6 6 0 0 0 14 10, L 8 14",5],["M 8 15, A 6 6 0 0 1 2 8, L 8 13",5]],[["M 7 0 9 0 9 16 7 16",5]]],o=[[["M 3 10, A 5 8 0 1 1 13 10, A 5 3 0 1 1 3 10",1],["M 5 8 7 8 7 16 5 16",1],["M 9 8 11 8 11 16 9 16",1],["M 5 8, A 1 1 0 1 1 7 8, A 1 1 0 1 1 5 8, M 9 8, A 1 1 0 1 1 11 8, A 1 1 0 1 1 9 8",4]],[["M 3 10, A 5 8 0 1 1 13 10, A 5 3 0 1 1 3 10",1],["M 5 8, A 1 1 0 1 1 7 8, M 9 8, A 1 1 0 1 1 11 8",4]],[["M 3 10, A 5 5 0 1 1 13 10, A 5 5 0 1 1 3 10",1],["M 5 8 7 8 7 16 5 16",1],["M 9 8 11 8 11 16 9 16",1],["M 5 8, A 1 1 0 1 1 7 8, A 1 1 0 1 1 5 8, M 9 8, A 1 1 0 1 1 11 8, A 1 1 0 1 1 9 8",4]],[["M 3 10, A 5 5 0 1 1 13 10, A 5 5 0 1 1 3 10",1],["M 5 8, A 1 1 0 1 1 7 8, M 9 8, A 1 1 0 1 1 11 8",4]],[["M 3 10, A 5 8 0 1 1 13 10, A 5 3 0 1 1 3 10",1],["M 5 8 7 8 7 16 5 16",1],["M 9 8 11 8 11 16 9 16",1],["M 4 8, A 4 4 0 1 1 12 8, A 4 4 0 1 1 4 8",4],["M 7 8, A 1 1 0 1 1 9 8, A 1 1 0 1 1 7 8",5]],[["M 3 10, A 5 8 0 1 1 13 10, A 5 3 0 1 1 3 10",1],["M 4 8, A 4 4 0 1 1 12 8, A 4 4 0 1 1 4 8",4],["M 7 8, A 1 1 0 1 1 9 8",5]],[["M 3 10, A 5 5 0 1 1 13 10, A 5 5 0 1 1 3 10",1],["M 5 8 7 8 7 16 5 16",1],["M 9 8 11 8 11 16 9 16",1],["M 4 8, A 4 4 0 1 1 12 8, A 4 4 0 1 1 4 8",4],["M 7 8, A 1 1 0 1 1 9 8, A 1 1 0 1 1 7 8",5]],[["M 3 10, A 5 5 0 1 1 13 10, A 5 5 0 1 1 3 10",1],["M 4 8, A 4 4 0 1 1 12 8, A 4 4 0 1 1 4 8",4],["M 7 8, A 1 1 0 1 1 9 8",5]]];let h=[5,4,6];function d(t,e){let i=s(e.tileWidth*h.length,e.tileHeight);for(var a in h){let s=t*e.tileWidth,n=h[a]*e.tileHeight,r=a*e.tileWidth,l=0;i.ctx.drawImage(e.img,s,n,e.tileWidth,e.tileHeight,r,l,e.tileWidth,e.tileHeight)}return i}function g(t,e){let i=s(e.tileWidth,e.tileHeight),a=t*e.tileWidth,n=e.sec1Rows*e.tileHeight;return i.ctx.drawImage(e.img,a,n,e.tileWidth,e.tileHeight,0,0,e.tileWidth,e.tileHeight),i}function f(t,e,i){let a=i.tileWidth,n=i.tileHeight,c=s(a,n*(e+1)),o=t*a,h=r*n;c.ctx.drawImage(i.img,o,h,a,n,0,0,a,n),h=l*n;for(var d=0;d<e;d++)c.ctx.drawImage(i.img,o,h,a,n,0,(1+d)*n,a,n);return c}function m(t,e,i){return"A"===t?t+e.map((t,e)=>e<2||e>4?t*i:t).join(" "):t+e.map(t=>t*i).join(" ")}function u(t,e,i,s){t.fillStyle=i;let a=e.split(",");for(var n=0;n<a.length;n++){let t=a[n].trim().split(" "),e=t.shift();a[n]=m(e,t,s)}t.fill(new Path2D(a.join(" ")))}function M(t,e,i,s){for(var a in e)u(t,e[a][0],i[e[a][1]],s)}class p{constructor(t){this.raf=null,this.setState(t)}setState(t){this.state=t}start(){this.now=performance.now(),this.last=this.now,this.elapsed=0,this.accumulator=0,requestAnimationFrame(this.update.bind(this))}stop(){cancelAnimationFrame(this.raf)}update(){if(this.raf=requestAnimationFrame(this.update.bind(this)),this.now=performance.now(),this.elapsed=this.now-this.last,this.last=this.now,!(this.elapsed>1e3)){for(this.state.prepare(),this.accumulator+=this.elapsed;this.accumulator>=1e3/60;)this.state.update(1/60*10),this.accumulator-=1e3/60;this.state.render()}}}let w="ongamepadconnected"in window,A=[];const x={standard:["A","B","X","Y","L1","R1","L2","R2","SELECT","START","ANALOG1","ANALOG2","UP","DOWN","LEFT","RIGHT","MODE"]};function v(t){y(t.gamepad),console.log("Gamepad %i connected",t.gamepad.index)}function y(t){A[t.index]={device:t,mapping:x[t.mapping]||x.standard,cache:[],status:[]}}function b(t){delete A[t.gamepad.index],console.log("Gamepad %i disconnected",t.gamepad.index)}function H(){for(var t in w||function(){let t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];for(var e=0;e<t.length;e++)t[e]&&(t[e].index in A?A[t[e].index].device=t[e]:y(t[e]))}(),A){let i=A[t];i.cache=[...i.status],i.status=[];for(var e=0;e<i.device.buttons.length;e++)i.device.buttons[e].pressed&&i.status.push(i.mapping[e])}}function L(t,e=!1,i=0){if(!A[i])return!1;let s=A[i];t=t.toUpperCase();let a=s.status.includes(t);return!e&&s.cache.includes(t)&&(a=!1),a}class W{constructor(t){window.addEventListener("gamepadconnected",v),window.addEventListener("gamepaddisconnected",b),this.buttons=[],this.game=t,this.waveSpeed=100;let e=this.game,i={tilesX:Math.ceil(e.offscreen.width/e.tw),tilesY:2};i.img=s(i.tilesX*e.tw,i.tilesY*e.th),i.img.ctx.fillStyle=a[e.colors][0],i.img.ctx.fillRect(0,e.th,i.img.width,i.img.height);for(var r=0;r<i.tilesX;r++){let t=e.colors*e.tw,s=n*e.th,a=r*e.tw,l=0;i.img.ctx.drawImage(e.tileset.img,t,s,e.tw,e.th,a,l,e.tw,e.th)}this.wave=i,this.waveX=0,this.waveY=e.offscreen.height-i.img.height}prepare(){}setButton(t){this.buttons[t.index]=t.button,this.game.players[t.index].active=!0}update(t){H(),function(t){for(var e in A){let s=A[e];for(var i in s.mapping){let a=s.mapping[i];L(a,!1,e)&&t({index:e,button:a})}}}(this.setButton.bind(this));for(var e=0;e<4;e++){let i=this.game.players[e];i.active&&(i.y+=i.vy*t,i.vy+=9*t,i.y>this.game.platforms[e].y-this.game.th&&(i.y=this.game.platforms[e].y-this.game.th))}}render(){let t=this.game,e=t.offscreen,i=t.cam;e.ctx.fillStyle=this.game.bg,e.ctx.fillRect(0,0,e.width,e.height),e.ctx.drawImage(this.wave.img,this.waveX,this.waveY);for(var s=0;s<4;s++){e.ctx.save(),!1===t.players[s].active&&(e.ctx.globalAlpha=.25),e.ctx.drawImage(t.platforms[s].img,t.platforms[s].x,t.platforms[s].y);let i=t.trees[s].img.width,a=(t.trees[s].segments+1)*t.th,n=t.trees[s].x,r=t.trees[s].y;if(e.ctx.drawImage(t.trees[s].img,0,0,i,a,n,r,i,a),e.ctx.drawImage(t.players[s].img,t.players[s].x,t.players[s].y),this.buttons[s]){e.ctx.fillStyle="#ffffff",e.ctx.font="90px Arial";let t=this.buttons[s],l=e.ctx.measureText(t).width;e.ctx.fillText(t,n+i/2-l/2,r+a/2)}e.ctx.restore()}t.screen.ctx.drawImage(e,i.sx,i.sy,i.sw,i.sh,i.dx,i.dy,i.dw,i.dh)}}const S={colors:0,bg:"#52427a",scale:4,tilesH:64,tilesV:20};S.tileset=function(t){let e=a.length,i={tileWidth:16*t,tileHeight:16*t,columns:e,sec1Rows:c.length,sec2Rows:o.length/4};i.width=i.tileWidth*i.columns,i.rows=i.sec1Rows+i.sec2Rows,i.height=i.tileHeight*i.rows,i.img=s(i.width,i.height);for(var n=0;n<c.length;n++)for(var r=0;r<e;r++){let e=r*i.tileWidth,s=n*i.tileHeight;i.img.ctx.save(),i.img.ctx.translate(e,s),M(i.img.ctx,c[n],a[r],t),i.img.ctx.restore()}for(var l=0;l<4;l++){let e=l*i.tileWidth,s=i.sec1Rows*i.tileHeight;i.img.ctx.save(),i.img.ctx.translate(e,s),M(i.img.ctx,o[2*l],a[l],t),i.img.ctx.restore(),i.img.ctx.save(),i.img.ctx.translate(e,s+i.tileHeight),M(i.img.ctx,o[2*l+1],a[l],t),i.img.ctx.restore()}return i}(S.scale),S.tw=S.tileset.tileWidth,S.th=S.tileset.tileHeight,S.offscreen=s(S.tilesH*S.tw,S.tilesV*S.th),S.cam={},S.cam.baseHaight=S.offscreen.height,S.cam.x=Math.floor(S.offscreen.width/2),S.cam.y=Math.floor(S.offscreen.height/2),S.players=[],S.platforms=[],S.trees=[];for(var R=0;R<4;R++){let t=S.cam.x+5*(R-2)*S.tw+S.tw,e=(S.tilesV-4)*S.th;S.players[R]={active:!1,x:t+S.tw,y:e-S.th,jumping:!1,vy:-40,img:g(R,S.tileset)},S.platforms[R]={x:t,y:e,img:d(R,S.tileset)},S.trees[R]={x:t+S.tw,y:e-13*S.tw,segments:12,img:f(R,12,S.tileset)}}function I(){S.screen=s(window.innerWidth,window.innerHeight,"screen"),S.screen.ctx.fillStyle=S.bg,S.screen.ctx.fillRect(0,0,S.screen.width,S.screen.height);let t=S.cam;t.height=t.baseHaight,t.width=t.height*S.screen.width/S.screen.height,t.halfHeight=t.height/2,t.halfWidth=t.width/2,t.sx=t.x-t.halfWidth,t.sy=t.y-t.halfHeight,t.sw=t.width,t.sh=t.height,t.dx=0,t.dy=0,t.dw=S.screen.width,t.dh=S.screen.height}document.addEventListener("keypress",(function(t){"Space"===t.code&&(e=0,S.trees[e].segments>1&&(S.trees[e].segments-=1,S.trees[e].y+=S.tw));var e})),window.addEventListener("resize",I),I(),S.state=new W(S),S.loop=new p(S.state),S.loop.start()}]);